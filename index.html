import React, { useState, useEffect } from 'react'; import { Download } from
'lucide-react'; export default function QRCodeGenerator() { const [qrCodeUrl,
setQrCodeUrl] = useState(''); const [url, setUrl] =
useState('https://gps-coordinate-finder.vercel.app/'); const [logoText,
setLogoText] = useState('SMP MUSLIMIN'); const [size, setSize] = useState(400);
useEffect(() => { generateQRCode(); }, [url, logoText, size]); const
generateQRCode = () => { // Using QR Server API with custom styling const qrUrl
=
`https://api.qrserver.com/v1/create-qr-code/?size=${size}x${size}&data=${encodeURIComponent(url)}&format=svg`;
setQrCodeUrl(qrUrl); }; const downloadQRCode = () => { const canvas =
document.createElement('canvas'); const ctx = canvas.getContext('2d');
canvas.width = size; canvas.height = size; // Create image from QR code const
img = new Image(); img.crossOrigin = 'anonymous'; // Use PNG format for download
const qrPngUrl =
`https://api.qrserver.com/v1/create-qr-code/?size=${size}x${size}&data=${encodeURIComponent(url)}&format=png`;
img.onload = () => { // Draw QR code ctx.drawImage(img, 0, 0, size, size); //
Draw white rounded rectangle in center for logo const centerSize = size * 0.25;
const centerX = (size - centerSize) / 2; const centerY = (size - centerSize) /
2; const cornerRadius = 15; ctx.fillStyle = 'white'; ctx.strokeStyle =
'#1e40af'; ctx.lineWidth = 4; // Rounded rectangle ctx.beginPath();
ctx.moveTo(centerX + cornerRadius, centerY); ctx.lineTo(centerX + centerSize -
cornerRadius, centerY); ctx.quadraticCurveTo(centerX + centerSize, centerY,
centerX + centerSize, centerY + cornerRadius); ctx.lineTo(centerX + centerSize,
centerY + centerSize - cornerRadius); ctx.quadraticCurveTo(centerX + centerSize,
centerY + centerSize, centerX + centerSize - cornerRadius, centerY +
centerSize); ctx.lineTo(centerX + cornerRadius, centerY + centerSize);
ctx.quadraticCurveTo(centerX, centerY + centerSize, centerX, centerY +
centerSize - cornerRadius); ctx.lineTo(centerX, centerY + cornerRadius);
ctx.quadraticCurveTo(centerX, centerY, centerX + cornerRadius, centerY);
ctx.closePath(); ctx.fill(); ctx.stroke(); // Draw text ctx.fillStyle =
'#1e40af'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle'; // Split text
into two lines const words = logoText.split(' '); const fontSize = centerSize /
5; ctx.font = `bold ${fontSize}px Arial`; if (words.length === 2) {
ctx.fillText(words[0], size / 2, size / 2 - fontSize / 2);
ctx.fillText(words[1], size / 2, size / 2 + fontSize / 2); } else {
ctx.fillText(logoText, size / 2, size / 2); } // Download canvas.toBlob((blob)
=> { const url = URL.createObjectURL(blob); const a =
document.createElement('a'); a.href = url; a.download =
`QR-Code-${logoText.replace(/\s+/g, '-')}.png`; document.body.appendChild(a);
a.click(); document.body.removeChild(a); URL.revokeObjectURL(url); }); };
img.src = qrPngUrl; }; return (
<div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
  <div className="max-w-4xl mx-auto">
    <div className="bg-white rounded-2xl shadow-2xl p-8">
      {/* Header */}
      <div className="text-center mb-8">
        <h1 className="text-4xl font-bold text-gray-800 mb-2">
          ğŸ“± QR Code Generator
        </h1>
        <p className="text-gray-600">
          Generate QR Code dengan logo custom untuk sekolah
        </p>
      </div>

      <div className="grid md:grid-cols-2 gap-8">
        {/* Settings Panel */}
        <div className="space-y-6">
          <div>
            <label className="block text-sm font-semibold text-gray-700 mb-2">
              ğŸ”— URL Tujuan
            </label>
            <input type="text" value={url} onChange={(e) =>
            setUrl(e.target.value)} className="w-full px-4 py-3 border-2
            border-gray-300 rounded-lg focus:outline-none focus:ring-2
            focus:ring-blue-500 focus:border-transparent"
            placeholder="https://example.com" />
          </div>

          <div>
            <label className="block text-sm font-semibold text-gray-700 mb-2">
              âœï¸ Teks Logo (Max 2 kata)
            </label>
            <input type="text" value={logoText} onChange={(e) =>
            setLogoText(e.target.value)} className="w-full px-4 py-3 border-2
            border-gray-300 rounded-lg focus:outline-none focus:ring-2
            focus:ring-blue-500 focus:border-transparent" placeholder="SMP
            MUSLIMIN" />
          </div>

          <div>
            <label className="block text-sm font-semibold text-gray-700 mb-2">
              ğŸ“ Ukuran: {size}x{size} px
            </label>
            <input type="range" min="300" max="800" step="50" value={size}
            onChange={(e) => setSize(parseInt(e.target.value))}
            className="w-full h-2 bg-gray-200 rounded-lg appearance-none
            cursor-pointer" />
            <div className="flex justify-between text-xs text-gray-500 mt-1">
              <span>300px</span>
              <span>800px</span>
            </div>
          </div>

          <button
            onClick="{downloadQRCode}"
            className="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-6 py-4 rounded-lg font-bold text-lg transition-all transform hover:scale-105 shadow-lg flex items-center justify-center gap-2">
            <Download size="{24}" />
            Download QR Code
          </button>

          <div
            className="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg">
            <p className="text-sm text-yellow-800">
              <strong>ğŸ’¡ Tips:</strong> QR Code dengan logo di tengah tetap bisa
              di-scan karena memiliki error correction!
            </p>
          </div>
        </div>

        {/* Preview Panel */}
        <div className="flex flex-col items-center justify-center">
          <div
            className="bg-gradient-to-br from-gray-50 to-gray-100 p-8 rounded-2xl shadow-inner">
            <div className="bg-white p-4 rounded-xl shadow-lg relative">
              {qrCodeUrl && (
              <img src="{qrCodeUrl}" alt="QR Code" className="w-full h-auto" />
              )} {/* Logo overlay simulation */}
              <div
                className="absolute inset-0 flex items-center justify-center pointer-events-none">
                <div
                  className="bg-white border-4 border-blue-700 rounded-xl px-4 py-3 shadow-lg">
                  <div className="text-center">
                    {logoText.split(' ').map((word, idx) => (
                    <div
                      key="{idx}"
                      className="text-blue-700 font-bold text-xs md:text-sm">
                      {word}
                    </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>

            <p className="text-center text-gray-600 mt-4 text-sm font-medium">
              Preview QR Code
            </p>
          </div>

          <div
            className="mt-6 bg-blue-50 border border-blue-200 p-4 rounded-lg w-full">
            <p className="text-xs text-blue-800 text-center">
              <strong>ğŸ“± Scan untuk test:</strong><br />
              Arahkan ke: {url.substring(0, 40)}...
            </p>
          </div>
        </div>
      </div>

      {/* Instructions */}
      <div
        className="mt-8 bg-gradient-to-r from-green-50 to-emerald-50 border-l-4 border-green-500 p-6 rounded-lg">
        <h3 className="font-bold text-green-900 mb-3 text-lg">
          ğŸ“‹ Cara Menggunakan:
        </h3>
        <ol className="space-y-2 text-sm text-green-800">
          <li>
            1. Masukkan URL tujuan (sudah terisi dengan link GPS Coordinate
            Finder)
          </li>
          <li>
            2. Edit teks logo sesuai keinginan (max 2 kata untuk hasil terbaik)
          </li>
          <li>3. Atur ukuran QR code sesuai kebutuhan</li>
          <li>4. Klik tombol "Download QR Code" untuk download</li>
          <li>5. QR Code siap dicetak atau dibagikan! ğŸ‰</li>
        </ol>
      </div>
    </div>
  </div>
</div>
); }
